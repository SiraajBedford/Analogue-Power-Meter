Version 4
SHEET 1 1320 916
WIRE -80 -432 -128 -432
WIRE 96 -416 -16 -416
WIRE -80 -400 -208 -400
WIRE -48 -336 -48 -384
WIRE 160 -336 160 -368
WIRE 336 -336 160 -336
WIRE 544 -336 336 -336
WIRE -128 -288 -128 -432
WIRE 160 -288 160 -336
WIRE 160 -288 -128 -288
WIRE 160 -256 160 -288
WIRE 768 -224 768 -336
WIRE 160 -144 160 -176
WIRE -208 -128 -208 -400
WIRE 544 -128 544 -336
WIRE 576 -128 544 -128
WIRE 768 -128 768 -224
WIRE 768 -128 640 -128
WIRE 576 -96 528 -96
WIRE 784 -96 640 -96
WIRE 528 -48 528 -96
WIRE 784 -48 784 -96
WIRE 992 -48 784 -48
WIRE -800 -32 -800 -112
WIRE -944 32 -944 -48
WIRE 784 32 784 -48
WIRE 144 128 144 64
WIRE 144 128 -96 128
WIRE 352 128 144 128
WIRE -96 160 -96 128
WIRE 352 160 352 128
WIRE -1056 176 -1056 160
WIRE -944 176 -944 112
WIRE -800 176 -800 48
WIRE 784 240 784 112
WIRE -208 304 -208 -128
WIRE -96 304 -96 240
WIRE -96 304 -208 304
WIRE -16 304 -96 304
WIRE 240 304 192 304
WIRE 352 304 352 240
WIRE 352 304 320 304
WIRE 784 352 784 320
WIRE -656 400 -656 368
WIRE 192 416 192 304
WIRE 192 416 -208 416
WIRE 64 432 64 304
WIRE 240 432 64 432
WIRE -96 464 -96 304
WIRE 352 464 352 304
WIRE -208 512 -208 416
WIRE -160 512 -208 512
WIRE 240 512 240 432
WIRE 288 512 240 512
WIRE -656 544 -656 480
WIRE -96 688 -96 560
WIRE 128 688 -96 688
WIRE 352 688 352 560
WIRE 352 688 128 688
WIRE 128 720 128 688
WIRE -1360 752 -1360 592
WIRE -1280 752 -1360 752
WIRE -1024 768 -1216 768
WIRE -320 768 -400 768
WIRE -208 768 -208 512
WIRE -208 768 -240 768
WIRE 240 768 240 512
WIRE 400 768 240 768
WIRE 512 768 480 768
WIRE -1280 784 -1456 784
WIRE -1456 800 -1456 784
WIRE -208 800 -208 768
WIRE 240 800 240 768
WIRE -1248 848 -1248 800
WIRE -208 896 -208 880
WIRE 240 896 240 880
FLAG 784 352 0
FLAG 768 -416 0
FLAG 528 -48 0
FLAG 128 720 0
FLAG -208 896 0
FLAG 240 896 0
FLAG 144 64 +5V_78
IOPIN 144 64 In
FLAG -656 544 0
FLAG -400 768 R_comparing_200mA
IOPIN -400 768 In
FLAG -48 -448 +5V_78
IOPIN -48 -448 In
FLAG -48 -336 0
FLAG 768 -224 V_mains
FLAG 992 -48 V_mains_TRIAC_result
IOPIN 992 -48 Out
FLAG 160 -464 +5V_78
IOPIN 160 -464 In
FLAG 160 -144 0
FLAG 336 -336 V_LED_+
FLAG -656 368 S
IOPIN -656 368 Out
FLAG -1056 176 0
FLAG -1056 80 -5V_CP
IOPIN -1056 80 Out
FLAG -944 176 0
FLAG -944 -48 +5V_78
IOPIN -944 -48 Out
FLAG -800 176 0
FLAG -800 -112 Current_REF
IOPIN -800 -112 Out
FLAG 512 768 S
IOPIN 512 768 In
FLAG -208 -128 Q
FLAG -1024 768 R_comparing_200mA
IOPIN -1024 768 Out
FLAG -1248 736 +5V_78
IOPIN -1248 736 In
FLAG -1248 848 0
FLAG -1360 592 Current_REF
IOPIN -1360 592 In
FLAG -1456 880 0
FLAG -1456 784 Ramp
SYMBOL res 768 16 R0
SYMATTR InstName LOAD1
SYMATTR Value 1k
SYMBOL res 768 224 R0
WINDOW 3 55 83 Left 2
SYMATTR Value 30m
SYMATTR InstName R_Sense1
SYMBOL voltage 768 -320 R180
WINDOW 0 24 96 Left 2
WINDOW 3 -260 49 Left 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V1
SYMATTR Value SINE(0 30.8 50)
SYMBOL npn 288 464 R0
SYMATTR InstName Q1
SYMATTR Value 2N3904
SYMBOL npn -160 464 R0
SYMATTR InstName Q2
SYMATTR Value 2N3904
SYMBOL res 224 784 R0
SYMATTR InstName R1
SYMATTR Value 100k
SYMBOL res -224 784 R0
SYMATTR InstName R2
SYMATTR Value 100k
SYMBOL res -224 752 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R3
SYMATTR Value 10k
SYMBOL res 496 752 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R4
SYMATTR Value 10k
SYMBOL res 336 144 R0
SYMATTR InstName R5
SYMATTR Value 1k
SYMBOL res -112 144 R0
SYMATTR InstName R6
SYMATTR Value 1k
SYMBOL res 336 288 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R7
SYMATTR Value 10k
SYMBOL res 80 288 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R8
SYMATTR Value 10k
SYMBOL voltage -656 384 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V2
SYMATTR Value 5
SYMBOL Opamps\\opamp2 -48 -480 R0
SYMATTR InstName U1
SYMATTR Value TLC2272
SYMBOL npn 96 -464 R0
SYMATTR InstName Q3
SYMATTR Value 2N3904
SYMBOL AutoGenerated\\MOC3020 608 -112 R0
SYMATTR InstName U2
SYMBOL res 144 -272 R0
SYMATTR InstName R9
SYMATTR Value 5.8
SYMBOL voltage -1056 64 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V3
SYMATTR Value -5
SYMBOL voltage -944 16 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V4
SYMATTR Value 5
SYMBOL voltage -800 -48 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V5
SYMATTR Value 3
SYMBOL Opamps\\opamp2 -1248 704 R0
SYMATTR InstName U3
SYMATTR Value TLC2272
SYMBOL voltage -1456 784 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V6
SYMATTR Value PWL(0 0 1 2.5 2 5)
TEXT 832 552 Left 2 !.inc MOC302x.lib
TEXT 832 576 Left 2 !.inc BT134.lib
TEXT 832 600 Left 2 !.inc 2N3904.lib
TEXT 832 624 Left 2 !.tran 0 4 0 1
TEXT 832 504 Left 2 !.inc TLC2272.lib
