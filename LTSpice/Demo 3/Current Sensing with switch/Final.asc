Version 4
SHEET 1 4420 4132
WIRE 2528 2416 2176 2416
WIRE 2848 2416 2608 2416
WIRE 2176 2512 2176 2416
WIRE 2352 2512 2176 2512
WIRE 2480 2512 2416 2512
WIRE 2848 2512 2848 2416
WIRE 2848 2512 2720 2512
WIRE 1632 2560 1632 2448
WIRE 880 2624 832 2624
WIRE 1056 2640 944 2640
WIRE 880 2656 752 2656
WIRE 1440 2656 1344 2656
WIRE 1632 2656 1632 2560
WIRE 1632 2656 1504 2656
WIRE 1440 2688 1392 2688
WIRE 1632 2688 1504 2688
WIRE 1648 2688 1632 2688
WIRE 912 2720 912 2672
WIRE 1120 2720 1120 2688
WIRE 1296 2720 1120 2720
WIRE 1344 2720 1344 2656
WIRE 1344 2720 1296 2720
WIRE 3024 2720 2976 2720
WIRE 1392 2736 1392 2688
WIRE 2720 2736 2720 2512
WIRE 2736 2736 2720 2736
WIRE 3200 2736 3088 2736
WIRE 3360 2736 3200 2736
WIRE 2176 2752 2176 2512
WIRE 2256 2752 2176 2752
WIRE 2848 2752 2848 2512
WIRE 2848 2752 2800 2752
WIRE 3024 2752 2848 2752
WIRE 832 2768 832 2624
WIRE 1120 2768 1120 2720
WIRE 1120 2768 832 2768
WIRE 1952 2768 1904 2768
WIRE 2480 2768 2480 2512
WIRE 2480 2768 2320 2768
WIRE 2624 2768 2480 2768
WIRE 2704 2768 2688 2768
WIRE 2736 2768 2704 2768
WIRE 2128 2784 2016 2784
WIRE 2256 2784 2128 2784
WIRE 1120 2800 1120 2768
WIRE 1952 2800 1936 2800
WIRE 1648 2816 1648 2688
WIRE 2704 2896 2704 2768
WIRE 1120 2912 1120 2880
WIRE 2976 2960 2976 2720
WIRE 3040 2960 2976 2960
WIRE 3200 2960 3200 2736
WIRE 3200 2960 3120 2960
WIRE 1648 2992 1648 2896
WIRE 1936 2992 1936 2800
WIRE 1936 2992 1648 2992
WIRE 2976 2992 2976 2960
WIRE 1904 3008 1904 2768
WIRE 1968 3008 1904 3008
WIRE 2128 3008 2128 2784
WIRE 2128 3008 2048 3008
WIRE 1648 3024 1648 2992
WIRE 1904 3040 1904 3008
WIRE 2704 3056 2704 2960
WIRE 2976 3104 2976 3072
WIRE 1648 3136 1648 3104
WIRE 1904 3152 1904 3120
WIRE 1104 3184 1104 3120
WIRE 1104 3184 864 3184
WIRE 1312 3184 1104 3184
WIRE 864 3216 864 3184
WIRE 1312 3216 1312 3184
WIRE 3360 3328 3360 3168
WIRE 3440 3328 3360 3328
WIRE 3696 3344 3504 3344
WIRE 752 3360 752 2656
WIRE 864 3360 864 3296
WIRE 864 3360 752 3360
WIRE 944 3360 864 3360
WIRE 1200 3360 1152 3360
WIRE 1312 3360 1312 3296
WIRE 1312 3360 1280 3360
WIRE 3440 3360 3360 3360
WIRE 3360 3424 3360 3360
WIRE 3472 3424 3472 3376
WIRE 1152 3472 1152 3360
WIRE 1152 3472 752 3472
WIRE 1024 3488 1024 3360
WIRE 1200 3488 1024 3488
WIRE 864 3520 864 3360
WIRE 1312 3520 1312 3360
WIRE 752 3568 752 3472
WIRE 800 3568 752 3568
WIRE 1200 3568 1200 3488
WIRE 1248 3568 1200 3568
WIRE 3360 3632 3360 3504
WIRE 3008 3696 3008 3616
WIRE 864 3744 864 3616
WIRE 1088 3744 864 3744
WIRE 1312 3744 1312 3616
WIRE 1312 3744 1088 3744
WIRE 2864 3760 2864 3680
WIRE 1088 3776 1088 3744
WIRE 640 3824 560 3824
WIRE 752 3824 752 3568
WIRE 752 3824 720 3824
WIRE 1200 3824 1200 3568
WIRE 1360 3824 1200 3824
WIRE 1472 3824 1440 3824
WIRE 1488 3824 1472 3824
WIRE 752 3856 752 3824
WIRE 1200 3856 1200 3824
WIRE 1488 3888 1488 3824
WIRE 2752 3904 2752 3888
WIRE 2864 3904 2864 3840
WIRE 3008 3904 3008 3776
WIRE 752 3952 752 3936
WIRE 1200 3952 1200 3936
WIRE 1488 4032 1488 3968
FLAG 1648 3136 0
FLAG 2752 3904 0
FLAG 2752 3808 -5V_CP
IOPIN 2752 3808 Out
FLAG 1984 2816 -5V_CP
IOPIN 1984 2816 In
FLAG 1984 2752 +5V_78
IOPIN 1984 2752 In
FLAG 1904 3152 0
FLAG 2704 3056 0
FLAG 2288 2736 +5V_78
IOPIN 2288 2736 In
FLAG 2288 2800 -5V_CP
IOPIN 2288 2800 In
FLAG 3056 2768 -5V_CP
IOPIN 3056 2768 In
FLAG 3056 2704 +5V_78
IOPIN 3056 2704 In
FLAG 2976 3104 0
FLAG 2768 2720 +5V_78
IOPIN 2768 2720 In
FLAG 2768 2784 -5V_CP
IOPIN 2768 2784 In
FLAG 1632 2368 0
FLAG 1392 2736 0
FLAG 1088 3776 0
FLAG 752 3952 0
FLAG 1200 3952 0
FLAG 2864 3904 0
FLAG 2864 3680 +5V_78
IOPIN 2864 3680 Out
FLAG 1104 3120 +5V_78
IOPIN 1104 3120 In
FLAG 1488 4032 0
FLAG 3696 3344 R_comparing_200mA
IOPIN 3696 3344 Out
FLAG 560 3824 R_comparing_200mA
IOPIN 560 3824 In
FLAG 912 2608 +5V_78
IOPIN 912 2608 In
FLAG 912 2720 0
FLAG 1632 2560 V_mains
FLAG 1632 2688 V_mains_TRIAC_result
FLAG 1120 2592 +5V_78
IOPIN 1120 2592 In
FLAG 1120 2912 0
FLAG 3008 3904 0
FLAG 3008 3616 Current_REF
IOPIN 3008 3616 Out
FLAG 3472 3312 +5V_78
IOPIN 3472 3312 In
FLAG 3472 3424 0
FLAG 1296 2720 V_LED_+
FLAG 3360 3168 Current_REF
IOPIN 3360 3168 In
FLAG 1472 3824 S
FLAG 3360 3632 0
SYMBOL res 1632 2800 R0
SYMATTR InstName LOAD1
SYMATTR Value 100
SYMBOL res 1632 3008 R0
WINDOW 3 55 83 Left 2
SYMATTR Value 30m
SYMATTR InstName R_Sense1
SYMBOL voltage 2752 3792 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V3
SYMATTR Value -5
SYMBOL Opamps\\opamp2 1984 2720 R0
SYMATTR InstName U1
SYMATTR Value TLC2272
SYMBOL res 2064 2992 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R1
SYMATTR Value 150k
SYMBOL res 1888 3024 R0
SYMATTR InstName R2
SYMATTR Value 1k
SYMBOL cap 2688 2896 R0
SYMATTR InstName C1
SYMATTR Value 100n
SYMBOL Opamps\\opamp2 2288 2704 R0
SYMATTR InstName U2
SYMATTR Value TLC2272
SYMBOL diode 2624 2784 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D1
SYMATTR Value 1N4148
SYMBOL Opamps\\opamp2 3056 2672 R0
SYMATTR InstName U3
SYMATTR Value TLC2272
SYMBOL res 3136 2944 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R3
SYMATTR Value 2.2k
SYMBOL res 2960 2976 R0
SYMATTR InstName R4
SYMATTR Value 1k
SYMBOL diode 2352 2528 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D2
SYMATTR Value 1N4148
SYMBOL Opamps\\opamp2 2768 2688 R0
SYMATTR InstName U4
SYMATTR Value TLC2272
SYMBOL res 2624 2400 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R5
SYMATTR Value 20k
SYMBOL voltage 1632 2464 R180
WINDOW 0 24 96 Left 2
WINDOW 3 24 16 Left 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V4
SYMATTR Value SINE(0 30.8 50)
SYMBOL npn 1248 3520 R0
SYMATTR InstName Q1
SYMATTR Value 2N3904
SYMBOL npn 800 3520 R0
SYMATTR InstName Q2
SYMATTR Value 2N3904
SYMBOL res 1184 3840 R0
SYMATTR InstName R6
SYMATTR Value 100k
SYMBOL res 736 3840 R0
SYMATTR InstName R7
SYMATTR Value 100k
SYMBOL res 736 3808 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R8
SYMATTR Value 10k
SYMBOL res 1456 3808 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R9
SYMATTR Value 10k
SYMBOL res 1296 3200 R0
SYMATTR InstName R10
SYMATTR Value 1k
SYMBOL res 848 3200 R0
SYMATTR InstName R11
SYMATTR Value 1k
SYMBOL res 1296 3344 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R12
SYMATTR Value 10k
SYMBOL res 1040 3344 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R13
SYMATTR Value 10k
SYMBOL voltage 2864 3744 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V5
SYMATTR Value 5
SYMBOL voltage 1488 3872 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V6
SYMATTR Value 5
SYMBOL Opamps\\opamp2 912 2576 R0
SYMATTR InstName U5
SYMATTR Value TLC2272
SYMBOL npn 1056 2592 R0
SYMATTR InstName Q3
SYMATTR Value 2N3904
SYMBOL AutoGenerated\\MOC3020 1472 2672 R0
SYMATTR InstName U6
SYMBOL res 1104 2784 R0
SYMATTR InstName R14
SYMATTR Value 5.8
SYMBOL voltage 3008 3680 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V7
SYMATTR Value 3
SYMBOL Opamps\\opamp2 3472 3280 R0
SYMATTR InstName U7
SYMATTR Value TLC2272
SYMBOL voltage 3360 3408 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V1
SYMATTR Value PULSE(0 5 0 0 0 1 2)
TEXT 2168 3832 Left 2 !.inc TL081.lib
TEXT 2168 3864 Left 2 !.inc TLC2272.LIB
TEXT 2168 3736 Left 2 !.inc MOC302x.lib
TEXT 2168 3760 Left 2 !.inc BT134.lib
TEXT 2168 3784 Left 2 !.inc 2N3904.lib
TEXT 2168 3808 Left 2 !.tran 0 10 0 1
TEXT 2168 3712 Left 2 !.inc TL081.lib
TEXT 2168 3688 Left 2 !.inc TLC2272.lib
