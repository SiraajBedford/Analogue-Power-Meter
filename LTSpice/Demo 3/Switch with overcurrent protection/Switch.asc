Version 4
SHEET 1 972 1776
WIRE 448 -320 256 -320
WIRE 192 -304 32 -304
WIRE 224 -240 224 -288
WIRE 32 -160 32 -304
WIRE -608 -80 -736 -80
WIRE -448 -80 -528 -80
WIRE -1296 32 -1296 -32
WIRE -1296 32 -1536 32
WIRE -1088 32 -1296 32
WIRE -1536 64 -1536 32
WIRE -1088 64 -1088 32
WIRE -1536 208 -1536 144
WIRE -1536 208 -1728 208
WIRE -1456 208 -1536 208
WIRE -1200 208 -1248 208
WIRE -1088 208 -1088 144
WIRE -1088 208 -1120 208
WIRE -1248 320 -1248 208
WIRE -1248 320 -1648 320
WIRE 256 320 256 208
WIRE -1376 336 -1376 208
WIRE -1200 336 -1376 336
WIRE -1536 368 -1536 208
WIRE -1088 368 -1088 208
WIRE -496 384 -544 384
WIRE -320 400 -432 400
WIRE -1648 416 -1648 320
WIRE -1600 416 -1648 416
WIRE -1200 416 -1200 336
WIRE -1152 416 -1200 416
WIRE -496 416 -720 416
WIRE 64 416 -32 416
WIRE 256 416 256 320
WIRE 256 416 128 416
WIRE 64 448 16 448
WIRE 256 448 128 448
WIRE 272 448 256 448
WIRE 752 448 752 368
WIRE -464 480 -464 432
WIRE -256 480 -256 448
WIRE -80 480 -256 480
WIRE -32 480 -32 416
WIRE -32 480 -80 480
WIRE 16 496 16 448
WIRE 576 512 576 432
WIRE 656 512 656 432
WIRE -544 528 -544 384
WIRE -256 528 -256 480
WIRE -256 528 -544 528
WIRE 272 528 272 448
WIRE -256 560 -256 528
WIRE -1536 592 -1536 464
WIRE -1312 592 -1536 592
WIRE -1088 592 -1088 464
WIRE -1088 592 -1312 592
WIRE -1312 624 -1312 592
WIRE 576 656 576 592
WIRE 656 656 656 592
WIRE 752 656 752 528
WIRE -1760 672 -1840 672
WIRE -1648 672 -1648 416
WIRE -1648 672 -1680 672
WIRE -1200 672 -1200 416
WIRE -1040 672 -1200 672
WIRE -864 672 -960 672
WIRE -256 672 -256 640
WIRE 272 672 272 608
WIRE -1648 704 -1648 672
WIRE -1200 704 -1200 672
WIRE -1648 800 -1648 784
WIRE -1200 800 -1200 784
FLAG 256 128 0
FLAG 16 496 0
FLAG -1312 624 0
FLAG -1648 800 0
FLAG -1200 800 0
FLAG 576 656 0
FLAG 576 432 +5V_78
IOPIN 576 432 Out
FLAG -1296 -32 +5V_78
IOPIN -1296 -32 In
FLAG 656 656 0
FLAG 656 432 S_beetle_reset_pin
IOPIN 656 432 Out
FLAG 448 -320 R_comparing_200mA
IOPIN 448 -320 Out
FLAG -1840 672 R_comparing_200mA
IOPIN -1840 672 In
FLAG -864 672 S_beetle_reset_pin
IOPIN -864 672 In
FLAG -1728 208 V_before_buffer
IOPIN -1728 208 Out
FLAG -464 368 +5V_78
IOPIN -464 368 In
FLAG -464 480 0
FLAG 256 320 V_mains
FLAG 256 448 V_mains_TRIAC_result
FLAG -256 352 +5V_78
IOPIN -256 352 In
FLAG -256 672 0
FLAG 752 656 0
FLAG 752 368 Current_Transducer_Output_for_200mA
IOPIN 752 368 Out
FLAG 224 -352 +5V_78
IOPIN 224 -352 In
FLAG 224 -240 0
FLAG 192 -336 Current_Transducer_Output_for_200mA
IOPIN 192 -336 In
FLAG 32 -160 Compare_for_200mA
IOPIN 32 -160 In
FLAG -736 -80 0
FLAG -448 -80 Compare_for_200mA
IOPIN -448 -80 Out
FLAG 272 672 0
FLAG -720 416 V_before_buffer
IOPIN -720 416 In
FLAG -80 480 V_LED_+
SYMBOL voltage 256 224 R180
WINDOW 0 24 96 Left 2
WINDOW 3 24 16 Left 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V1
SYMATTR Value SINE(0 30.8 50)
SYMBOL res 256 512 R0
SYMATTR InstName R_LOAD
SYMATTR Value 100
SYMBOL npn -1152 368 R0
SYMATTR InstName Q1
SYMATTR Value 2N3904
SYMBOL npn -1600 368 R0
SYMATTR InstName Q2
SYMATTR Value 2N3904
SYMBOL res -1216 688 R0
SYMATTR InstName R2
SYMATTR Value 100k
SYMBOL res -1664 688 R0
SYMATTR InstName R3
SYMATTR Value 100k
SYMBOL res -1664 656 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R4
SYMATTR Value 10k
SYMBOL res -944 656 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R5
SYMATTR Value 10k
SYMBOL res -1104 48 R0
SYMATTR InstName R6
SYMATTR Value 1k
SYMBOL res -1552 48 R0
SYMATTR InstName R7
SYMATTR Value 1k
SYMBOL res -1104 192 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R8
SYMATTR Value 10k
SYMBOL res -1360 192 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R9
SYMATTR Value 10k
SYMBOL voltage 576 496 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V2
SYMATTR Value 5
SYMBOL voltage 656 496 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V3
SYMATTR Value 5
SYMBOL Opamps\\opamp2 -464 336 R0
SYMATTR InstName U4
SYMATTR Value TLC2272
SYMBOL npn -320 352 R0
SYMATTR InstName Q3
SYMATTR Value 2N3904
SYMBOL AutoGenerated\\MOC3020 96 432 R0
SYMATTR InstName U1
SYMBOL res -272 544 R0
SYMATTR InstName R10
SYMATTR Value 3.3
SYMBOL voltage 752 432 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V5
SYMATTR Value 3.25
SYMBOL Opamps\\opamp2 224 -384 R0
SYMATTR InstName U2
SYMATTR Value TLC2272
SYMBOL voltage -512 -80 R90
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V6
SYMATTR Value 3.7
TEXT -1792 -336 Left 2 !.inc MOC302x.lib
TEXT -1792 -312 Left 2 !.inc BT134.lib
TEXT -1792 -288 Left 2 !.inc 2N3904.lib
TEXT -1792 -264 Left 2 !.tran 0 1 0 1
TEXT -1792 -360 Left 2 !.inc TL081.lib
TEXT -1792 -384 Left 2 !.inc TLC2272.lib
