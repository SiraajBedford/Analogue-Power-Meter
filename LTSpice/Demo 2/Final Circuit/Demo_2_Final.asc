Version 4
SHEET 1 5272 3200
WIRE 1904 512 1712 512
WIRE 1952 512 1904 512
WIRE 2096 512 2032 512
WIRE 2176 512 2096 512
WIRE 2352 512 2176 512
WIRE 2688 512 2352 512
WIRE 3136 512 2688 512
WIRE 3360 512 3136 512
WIRE 2096 576 1904 576
WIRE 1904 592 1904 576
WIRE 1472 640 1424 640
WIRE 1712 640 1712 512
WIRE 1712 640 1680 640
WIRE 2352 640 2352 512
WIRE 2464 640 2352 640
WIRE 2512 640 2464 640
WIRE 2608 640 2576 640
WIRE 2704 640 2608 640
WIRE 2464 656 2464 640
WIRE 2608 656 2608 640
WIRE 1472 672 1440 672
WIRE 1776 672 1680 672
WIRE 1808 672 1776 672
WIRE 2176 672 2176 512
WIRE 2176 672 1888 672
WIRE 1056 688 1056 624
WIRE 1120 688 1056 688
WIRE 1136 688 1120 688
WIRE 1248 688 1200 688
WIRE 1392 688 1248 688
WIRE 1424 688 1424 640
WIRE 1424 688 1392 688
WIRE 1392 704 1392 688
WIRE 1440 704 1440 672
WIRE 1472 704 1440 704
WIRE 1712 704 1680 704
WIRE 1056 720 1056 688
WIRE 1120 720 1120 688
WIRE 1248 720 1248 688
WIRE 1776 736 1776 672
WIRE 1808 736 1808 672
WIRE 1824 736 1808 736
WIRE 1888 736 1888 672
WIRE 3136 736 3136 512
WIRE 2464 752 2464 720
WIRE 2464 752 2272 752
WIRE 2512 752 2464 752
WIRE 2544 752 2544 704
WIRE 2544 752 2512 752
WIRE 2608 752 2608 720
WIRE 2608 752 2544 752
WIRE 3360 768 3360 512
WIRE 2512 784 2512 752
WIRE 1120 816 1120 800
WIRE 1216 816 1120 816
WIRE 1120 832 1120 816
WIRE 1248 832 1248 784
WIRE 1392 832 1392 768
WIRE 1392 832 1248 832
WIRE 1440 832 1440 704
WIRE 1440 832 1392 832
WIRE 1568 832 1440 832
WIRE 1712 832 1712 704
WIRE 1712 832 1568 832
WIRE 1776 832 1776 816
WIRE 1776 832 1712 832
WIRE 2272 832 2272 752
WIRE 2272 832 1776 832
WIRE 3136 864 3136 816
WIRE 3296 864 3296 816
WIRE 3296 864 3216 864
WIRE 3376 864 3360 864
WIRE 1568 880 1568 832
WIRE 1056 944 1056 800
WIRE 1120 944 1120 912
WIRE 1120 944 1056 944
WIRE 1248 944 1248 832
WIRE 1248 944 1120 944
WIRE 3136 944 3136 864
WIRE 3376 976 3376 864
WIRE 3552 976 3376 976
WIRE 3744 976 3616 976
WIRE 3792 976 3744 976
WIRE 3904 976 3856 976
WIRE 4048 976 3904 976
WIRE 4176 976 4048 976
WIRE 2992 992 2912 992
WIRE 2000 1024 1680 1024
WIRE 2352 1024 2080 1024
WIRE 3744 1056 3744 976
WIRE 3136 1072 3136 1040
WIRE 3376 1088 3376 976
WIRE 4048 1120 4048 976
WIRE 1680 1136 1680 1024
WIRE 1856 1136 1680 1136
WIRE 1984 1136 1920 1136
WIRE 2352 1136 2352 1024
WIRE 2352 1136 2176 1136
WIRE 2912 1136 2912 992
WIRE 3232 1136 2912 1136
WIRE 3904 1136 3904 976
WIRE 2912 1184 2912 1136
WIRE 3376 1216 3376 1184
WIRE 2912 1328 2912 1264
WIRE 3376 1328 3376 1296
WIRE 3376 1328 2912 1328
WIRE 3744 1328 3744 1120
WIRE 3744 1328 3376 1328
WIRE 3904 1328 3904 1200
WIRE 3904 1328 3744 1328
WIRE 4048 1328 4048 1184
WIRE 4048 1328 3904 1328
WIRE 4176 1328 4048 1328
WIRE 2560 1344 2544 1344
WIRE 2176 1360 2176 1136
WIRE 2192 1360 2176 1360
WIRE 2736 1360 2624 1360
WIRE 2912 1360 2912 1328
WIRE 1680 1376 1680 1136
WIRE 1760 1376 1680 1376
WIRE 2352 1376 2352 1136
WIRE 2352 1376 2256 1376
WIRE 2560 1376 2352 1376
WIRE 1984 1392 1984 1136
WIRE 1984 1392 1824 1392
WIRE 2016 1392 1984 1392
WIRE 2128 1392 2080 1392
WIRE 2192 1392 2128 1392
WIRE 1216 1408 1216 816
WIRE 1216 1408 688 1408
WIRE 1760 1408 1216 1408
WIRE 2128 1472 2128 1392
WIRE 2544 1632 2544 1344
WIRE 2608 1632 2544 1632
WIRE 2736 1632 2736 1360
WIRE 2736 1632 2688 1632
WIRE 2544 1680 2544 1632
WIRE 2016 1776 1680 1776
WIRE 2352 1776 2096 1776
WIRE 2544 1808 2544 1760
WIRE 4208 1888 4064 1888
WIRE 1680 1904 1680 1776
WIRE 1840 1904 1680 1904
WIRE 1968 1904 1904 1904
WIRE 2352 1904 2352 1776
WIRE 2352 1904 2208 1904
WIRE 3744 1904 3632 1904
WIRE 4432 1904 4272 1904
WIRE 3744 1920 3744 1904
WIRE 4208 1920 3744 1920
WIRE 4240 1984 4240 1936
WIRE 4432 2064 4432 1904
WIRE 4496 2064 4432 2064
WIRE 4560 2064 4496 2064
WIRE 3632 2080 3632 1904
WIRE 3632 2080 3504 2080
WIRE 4704 2080 4640 2080
WIRE 4768 2080 4704 2080
WIRE 4944 2080 4848 2080
WIRE 5232 2080 4944 2080
WIRE 3632 2096 3632 2080
WIRE 4496 2096 4432 2096
WIRE 4560 2096 4496 2096
WIRE 2576 2112 2528 2112
WIRE 2208 2128 2208 1904
WIRE 2224 2128 2208 2128
WIRE 2752 2128 2640 2128
WIRE 1680 2144 1680 1904
WIRE 1744 2144 1680 2144
WIRE 2352 2144 2352 1904
WIRE 2352 2144 2288 2144
WIRE 2576 2144 2352 2144
WIRE 1504 2160 1456 2160
WIRE 1968 2160 1968 1904
WIRE 1968 2160 1808 2160
WIRE 2112 2160 1968 2160
WIRE 2192 2160 2176 2160
WIRE 2224 2160 2192 2160
WIRE 1680 2176 1568 2176
WIRE 1712 2176 1680 2176
WIRE 1744 2176 1712 2176
WIRE 1504 2192 1488 2192
WIRE 1200 2208 1200 2192
WIRE 4944 2224 4944 2080
WIRE 4208 2256 4064 2256
WIRE 3744 2272 3632 2272
WIRE 4432 2272 4432 2096
WIRE 4432 2272 4272 2272
WIRE 2192 2288 2192 2160
WIRE 3744 2288 3744 2272
WIRE 4208 2288 3744 2288
WIRE 2528 2352 2528 2112
WIRE 2592 2352 2528 2352
WIRE 2752 2352 2752 2128
WIRE 2752 2352 2672 2352
WIRE 4240 2368 4240 2304
WIRE 1200 2384 1200 2288
WIRE 1488 2384 1488 2192
WIRE 1488 2384 1200 2384
WIRE 2528 2384 2528 2352
WIRE 1456 2400 1456 2160
WIRE 1520 2400 1456 2400
WIRE 1680 2400 1680 2176
WIRE 1680 2400 1600 2400
WIRE 1200 2416 1200 2384
WIRE 1456 2432 1456 2400
WIRE 2192 2448 2192 2352
WIRE 2528 2496 2528 2464
WIRE 1200 2528 1200 2496
WIRE 1456 2544 1456 2512
WIRE 688 2800 688 1408
WIRE 3504 2800 3504 2080
WIRE 3504 2800 688 2800
WIRE 1712 2992 1712 2176
WIRE 3632 2992 3632 2272
WIRE 3632 2992 1712 2992
FLAG 1568 880 0
FLAG 1904 592 0
FLAG 2512 784 0
FLAG 2912 1360 0
FLAG 3136 1072 0
FLAG 2688 512 +12V_switchmode
FLAG 2224 1344 +5V_78
IOPIN 2224 1344 In
FLAG 1792 1360 +5V_78
IOPIN 1792 1360 In
FLAG 1792 1424 -5V_CP
IOPIN 1792 1424 In
FLAG 2224 1408 -5V_CP
IOPIN 2224 1408 In
FLAG 2128 1536 0
FLAG 2592 1328 +5V_78
IOPIN 2592 1328 In
FLAG 2592 1392 -5V_CP
IOPIN 2592 1392 In
FLAG 2544 1808 0
FLAG 4176 976 -5V_CP
IOPIN 4176 976 Out
FLAG 2704 640 +5V_78
IOPIN 2704 640 Out
FLAG 1200 2528 0
FLAG 1536 2208 -5V_CP
IOPIN 1536 2208 In
FLAG 1536 2144 +5V_78
IOPIN 1536 2144 In
FLAG 1456 2544 0
FLAG 2192 2448 0
FLAG 1776 2128 +5V_78
IOPIN 1776 2128 In
FLAG 1776 2192 -5V_CP
IOPIN 1776 2192 In
FLAG 2608 2160 -5V_CP
IOPIN 2608 2160 In
FLAG 2608 2096 +5V_78
IOPIN 2608 2096 In
FLAG 2528 2496 0
FLAG 2256 2112 +5V_78
IOPIN 2256 2112 In
FLAG 2256 2176 -5V_CP
IOPIN 2256 2176 In
FLAG 1056 624 To_current_peak_detector
IOPIN 1056 624 Out
FLAG 1200 2192 To_current_peak_detector
IOPIN 1200 2192 In
FLAG 4704 2080 XOR_out
FLAG 4496 2064 XOR_in1
FLAG 4496 2096 XOR_in2
FLAG 4240 1872 +5V_78
IOPIN 4240 1872 In
FLAG 4240 2240 +5V_78
IOPIN 4240 2240 In
FLAG 4944 2288 0
FLAG 4064 1888 0
FLAG 4064 2256 0
FLAG 4240 2368 0
FLAG 4240 1984 0
SYMBOL voltage 1056 704 R0
WINDOW 0 -233 51 Left 2
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
WINDOW 3 -205 99 Left 2
SYMATTR InstName V_source_RMS1
SYMATTR Value SINE(0 30.8 50)
SYMBOL diode 1136 704 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D3
SYMBOL cap 1232 720 R0
SYMATTR InstName C5
SYMATTR Value 150µ
SYMBOL AutoGenerated\\LM2595_ADJ_TRANS 1568 672 R0
WINDOW 3 8 56 Top 2
SYMATTR InstName U2
SYMBOL cap 1376 704 R0
WINDOW 3 -43 54 Left 2
WINDOW 0 -24 10 Left 2
SYMATTR Value 122µ
SYMATTR InstName C6
SYMBOL schottky 1920 576 R180
WINDOW 0 -36 39 Left 2
WINDOW 3 -86 14 Left 2
SYMATTR InstName D4
SYMATTR Value 1N5822
SYMBOL res 1760 720 R0
WINDOW 0 -29 56 Left 2
WINDOW 3 37 51 Left 2
SYMATTR InstName R4
SYMATTR Value 1k
SYMBOL res 1904 656 R90
WINDOW 0 -3 55 VBottom 2
WINDOW 3 26 55 VTop 2
SYMATTR InstName R5
SYMATTR Value 8.2k
SYMBOL cap 1888 720 R90
WINDOW 0 43 5 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName Cff
SYMATTR Value 3.7n
SYMBOL ind 1936 528 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 13 90 VBottom 2
SYMATTR InstName L1
SYMATTR Value 68µ
SYMBOL cap 2080 512 R0
WINDOW 0 21 13 Left 2
WINDOW 3 21 55 Left 2
SYMATTR InstName C7
SYMATTR Value 122µ
SYMBOL cap 2448 656 R0
SYMATTR InstName C1
SYMATTR Value 0.33µ
SYMBOL cap 2592 656 R0
SYMATTR InstName C2
SYMATTR Value 0.1µ
SYMBOL npn 3072 944 R0
SYMATTR InstName Q1
SYMATTR Value 2N3904
SYMBOL npn 3296 768 R0
WINDOW 3 56 68 Invisible 2
SYMATTR Value 2N3904
SYMATTR InstName Q2
SYMBOL npn 3312 1088 R0
SYMATTR InstName Q3
SYMATTR Value 2N3904
SYMBOL voltage 2912 1168 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V1
SYMATTR Value PULSE(0 5 0 0 0 50u 100u)
SYMBOL res 3088 976 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R1
SYMATTR Value 1k
SYMBOL res 3328 1120 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R2
SYMATTR Value 1k
SYMBOL res 3120 720 R0
SYMATTR InstName R3
SYMATTR Value 1k
SYMBOL res 3232 848 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R6
SYMATTR Value 3.9k
SYMBOL res 3360 1200 R0
SYMATTR InstName R8
SYMATTR Value 33
SYMBOL cap 3616 960 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C3
SYMATTR Value 10µ
SYMBOL diode 3856 960 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName D1
SYMATTR Value 1N4148
SYMBOL diode 3728 1056 R0
SYMATTR InstName D2
SYMATTR Value 1N4148
SYMBOL cap 3888 1136 R0
SYMATTR InstName C4
SYMATTR Value 100µ
SYMBOL zener 4032 1120 R0
WINDOW 0 -31 34 Left 2
SYMATTR InstName D5
SYMATTR Value 1N750
SYMBOL res 1104 704 R0
WINDOW 0 -28 13 Left 2
WINDOW 3 40 54 Left 2
SYMATTR InstName R20
SYMATTR Value 1.5Meg
SYMBOL res 1104 816 R0
WINDOW 0 29 30 Left 2
SYMATTR InstName R21
SYMATTR Value 100k
SYMBOL AutoGenerated\\LM7805 2544 672 R0
SYMATTR InstName U1
SYMBOL Opamps\\opamp2 2224 1312 R0
SYMATTR InstName U3
SYMATTR Value TLC2272
SYMBOL Opamps\\opamp2 1792 1328 R0
SYMATTR InstName U4
SYMATTR Value TLC2272
SYMBOL diode 1856 1152 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D6
SYMATTR Value 1N4148
SYMBOL res 2096 1008 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R11
SYMATTR Value 10k
SYMBOL diode 2016 1408 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D8
SYMATTR Value 1N4148
SYMBOL cap 2112 1472 R0
SYMATTR InstName C8
SYMATTR Value 1n
SYMBOL Opamps\\opamp2 2592 1296 R0
SYMATTR InstName U6
SYMATTR Value TLC2272
SYMBOL res 2528 1664 R0
SYMATTR InstName R12
SYMATTR Value 1k
SYMBOL res 2704 1616 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R13
SYMATTR Value 1.2k
SYMBOL res 1184 2192 R0
SYMATTR InstName LOAD1
SYMATTR Value 100
SYMBOL res 1184 2400 R0
WINDOW 3 55 83 Left 2
SYMATTR Value 30m
SYMATTR InstName R_Sense1
SYMBOL Opamps\\opamp2 1536 2112 R0
SYMATTR InstName U5
SYMATTR Value TLC2272
SYMBOL res 1616 2384 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R7
SYMATTR Value 150k
SYMBOL res 1440 2416 R0
SYMATTR InstName R9
SYMATTR Value 1k
SYMBOL cap 2176 2288 R0
SYMATTR InstName C9
SYMATTR Value 100n
SYMBOL Opamps\\opamp2 1776 2096 R0
SYMATTR InstName U7
SYMATTR Value TLC2272
SYMBOL diode 2112 2176 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D7
SYMATTR Value 1N4148
SYMBOL Opamps\\opamp2 2608 2064 R0
SYMATTR InstName U8
SYMATTR Value TLC2272
SYMBOL res 2688 2336 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R10
SYMATTR Value 2.2k
SYMBOL res 2512 2368 R0
SYMATTR InstName R14
SYMATTR Value 1k
SYMBOL diode 1840 1920 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D9
SYMATTR Value 1N4148
SYMBOL Opamps\\opamp2 2256 2080 R0
SYMATTR InstName U9
SYMATTR Value TLC2272
SYMBOL res 2112 1760 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R15
SYMATTR Value 20k
SYMBOL XOR_2 4608 2080 R0
SYMATTR InstName U10
SYMBOL Opamps\\opamp2 4240 1840 R0
SYMATTR InstName U11
SYMATTR Value TLC2272
SYMBOL Opamps\\opamp2 4240 2208 R0
SYMATTR InstName U12
SYMATTR Value TLC2272
SYMBOL res 4864 2064 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R16
SYMATTR Value 7000
SYMBOL cap 4928 2224 R0
SYMATTR InstName C10
SYMATTR Value 30µ
TEXT 592 16 Left 2 !.tran 0 5 0 5
TEXT 768 40 Left 2 !.inc LM2595_ADJ_TRANS.LIB
TEXT 768 64 Left 2 !.inc ST_POWER_SCHOTTKY_V6.LIB
TEXT 768 88 Left 2 !.inc 2N3904.lib
TEXT 768 136 Left 2 !.inc TL081.lib
TEXT 768 112 Left 2 !.inc TLC2272.LIB
TEXT 768 16 Left 2 !.inc LM78XX_RS.lib
TEXT 768 160 Left 2 !.inc 1N400.lib
TEXT 768 184 Left 2 !.inc DigitalLogic.lib
